(()=>{"use strict";const e=document.querySelector(".locations__form"),t=document.querySelector(".locations__input"),n=document.querySelector(".info__temp"),o=document.querySelector(".info__name"),r=document.querySelector(".info__favorit-img"),i=document.querySelector(".locations__list"),s=document.querySelector(".locations__prev"),a=document.querySelector(".info__status"),c=document.querySelector(".info__feels-like"),u=document.querySelector(".info__btn"),l=document.querySelector(".info"),m=document.querySelector(".info__top"),d=document.querySelector(".info__bottom"),y=document.querySelector(".info__start-message"),g=document.querySelector(".info__btn"),f=document.querySelector(".more-info"),b=document.querySelector(".more-info-close__btn"),p=document.querySelector(".info__date"),_=document.querySelector(".info__day"),S=document.querySelector(".info__img"),v={sunriseEl:document.getElementById("sunrise"),sunsetEl:document.getElementById("sunset"),pressureEl:document.getElementById("pressure"),humidityEl:document.getElementById("humidity"),visibilityEl:document.getElementById("visibility"),windEl:document.getElementById("wind")},h="https://openweathermap.org/img/wn/",C={checkCurrentCityInStorage:()=>!!localStorage.getItem("current city"),checkFavoriteCitiesInStorage:()=>!!localStorage.getItem("favorite cities"),setCurrentCity(e){const t=JSON.stringify(e);localStorage.setItem("current city",t)},setFavoriteCities(e){const t=JSON.stringify(e);localStorage.setItem("favorite cities",t)},getCityInStorage:()=>JSON.parse(localStorage.getItem("current city")),getFavoriteCities:()=>JSON.parse(localStorage.getItem("favorite cities"))},E=new Set;function k(e){const t=`\n    <li class="locations__item">\n      <button class="locations__btn btn-reset">${e.name}</button>\n      <button class="locations__remove-btn btn-reset">\n        <img\n          src="img/icons/cross.png"\n          alt=""\n          class="locations__remove-img"\n        />\n      </button>\n    </li>\n    `;s.remove(),i.insertAdjacentHTML("afterbegin",t),E.add(e),C.setFavoriteCities([...E])}function w(e,t){return"object"==typeof t?[...t].findIndex((t=>t.name===e)):t.findIndex((t=>t.name===e))}function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function $(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function I(e){return $(1,arguments),function(e){$(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===q(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}(1e3*function(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}(e))}function x(e){const t=I(e),n=t.getDate(),o=t.getDay(),r=t.getMonth(),i=t.getFullYear();let s,a;switch(r){case 0:s="January";break;case 1:s="February";break;case 2:s="March";break;case 3:s="April";break;case 4:s="May";break;case 5:s="June";break;case 6:s="July";break;case 7:s="August";break;case 8:s="September";break;case 9:s="October";break;case 10:s="November";break;case 11:s="December"}switch(o){case 1:a="Mondey";break;case 2:a="Tuesday";break;case 3:a="Wednesday";break;case 4:a="Thursday";break;case 5:a="Friday";break;case 6:a="Saturday";break;case 7:a="Sunday"}return{day:n,nameDay:a,month:s,year:i}}const N={sunriseTime(e){let t,n;return t=I(e).getHours()<10?`0${I(e).getHours()}`:I(e).getHours(),n=I(e).getMinutes()<10?`${I(e).getMinutes()}0`:I(e).getMinutes(),`${t}:${n}`},sunsetTime(e){let t,n;return t=I(e).getHours()<10?`0${I(e).getHours()}`:I(e).getHours(),n=I(e).getMinutes()<10?`${I(e).getMinutes()}0`:I(e).getMinutes(),`${t}:${n}`}};function F(e){const t=e.name,r=(e.main.temp-273.5).toFixed(1),i=(e.main.feels_like-273.5).toFixed(1),{description:s}=e.weather[0],g=e.dt,{icon:f}=e.weather[0];var b;o.textContent=t,n.textContent=`${r} °C`,c.textContent=`Feels like: ${i} °C`,a.textContent=s.split(" ").map((e=>e[0].toUpperCase()+e.slice(1))).join(" "),p.textContent=`${x(g).day} ${x(g).month} ${x(g).year}`,_.textContent=`${x(g).nameDay}`,b=f,S.setAttribute("src",`${h}/${b}@2x.png`),u.classList.remove("is-hidden"),l.classList.remove("info--start"),m.classList.remove("is-hidden"),d.classList.remove("is-hidden"),y.remove(),C.setCurrentCity(e),M.push(e)}const M=[];function L(e){if(f.classList.toggle("is-hidden"),"info__btn btn-reset"===e.target.className){const t=w(e.target.parentElement.previousElementSibling.firstElementChild.textContent,E);!function(e){const{visibility:t,sys:{sunrise:n,sunset:o},main:{humidity:r,pressure:i},wind:{speed:s}}=e;v.sunriseEl.textContent=N.sunriseTime(n),v.sunsetEl.textContent=N.sunsetTime(o),v.pressureEl.textContent=`${i} hPa`,v.humidityEl.textContent=`${r} %`,v.visibilityEl.textContent=`${t} m`,v.windEl.textContent=`${s} m/s`}([...E][t])}}e.addEventListener("submit",(function(e){e.preventDefault();const n=t.value;t.value="",t.blur(),async function(e){try{const t=await async function(e){return(await fetch(e)).json()}(e);F(t)}catch(e){console.log(e)}}(`http://api.openweathermap.org/data/2.5/weather?q=${n}&appid=f660a2fb1e4bad108d6160b7f58c555f`)})),r.addEventListener("click",(function(){const e=M[M.length-1];(function(e){let t=!0;return E.forEach((n=>{n.name===e.name&&(t=!1)})),t})(e)&&k(e)})),i.addEventListener("click",(function(e){if("locations__remove-img"===e.target.className){const n=e.target,o=n.closest(".locations__item"),r=n.parentElement.previousElementSibling.textContent;o.remove(),E.forEach((e=>{e.name===r&&E.delete(e)})),t=E,C.setFavoriteCities([...t])}var t})),i.addEventListener("click",(function(e){if("locations__btn btn-reset"===e.target.className){const t=C.getFavoriteCities(),n=w(e.target.textContent,t);F([...E][n])}})),g.addEventListener("click",L),b.addEventListener("click",L),C.checkCurrentCityInStorage()&&F(C.getCityInStorage()),C.checkFavoriteCitiesInStorage()&&C.getFavoriteCities().forEach((e=>{k(e)}))})();